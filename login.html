<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CalmAI - Login</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icons/6.6.6/css/flag-icons.min.css">
    <style>
    :root {
        --primary-color: #5d8aa8;
        --secondary-color: #a8c6db;
        --accent-color: #ffb347;
        --light-color: #f5f9fc;
        --dark-color: #2c3e50;
        --success-color: #7bcfa9;
        --error-color: #e74c3c;
        --transition: all 0.3s ease;
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
        background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
        color: var(--dark-color);
        line-height: 1.6;
    }

    .container {
        display: flex;
        max-width: 1000px;
        width: 100%;
        min-height: 650px;
        border-radius: 25px;
        overflow: hidden;
        box-shadow: 0 15px 35px rgba(45, 85, 120, 0.1);
        background-color: white;
    }

    /* Graphic Side */
    .graphic-side {
        flex: 1;
        background: linear-gradient(to bottom right, var(--primary-color), var(--secondary-color));
        padding: 40px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        color: white;
        text-align: center;
        position: relative;
        overflow: hidden;
    }

    .graphic-side::before {
        content: "";
        position: absolute;
        width: 300px;
        height: 300px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.1);
        top: -100px;
        right: -100px;
    }

    .graphic-side::after {
        content: "";
        position: absolute;
        width: 200px;
        height: 200px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.05);
        bottom: -80px;
        left: -80px;
    }

    .logo {
        font-size: 2.8rem;
        margin-bottom: 20px;
        z-index: 1;
    }

    .graphic-side h2 {
        font-size: 3rem;
        margin-bottom: 15px;
        z-index: 1;
        font-weight: 700;
        letter-spacing: 1px;
    }

    .graphic-side p {
        font-size: 1.1rem;
        opacity: 0.9;
        max-width: 350px;
        z-index: 1;
    }

    .illustration {
        margin-top: 40px;
        font-size: 8rem;
        opacity: 0.8;
        z-index: 1;
        animation: float 6s ease-in-out infinite;
    }

    @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-20px); }
    }

    /* Form Side */
    .form-side {
        flex: 1.2;
        padding: 50px 40px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        position: relative;
    }

    /* Language Switcher */
    .language-switcher {
        position: absolute;
        top: 30px;
        left: 30px;
        display: flex;
        gap: 8px;
        z-index: 10;
    }

    .lang-btn {
        padding: 10px 20px;
        border: 2px solid var(--secondary-color);
        background: white;
        border-radius: 25px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        color: var(--dark-color);
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .lang-btn:hover {
        background-color: var(--light-color);
        transform: translateY(-2px);
    }

    .lang-btn.active {
        background-color: var(--primary-color);
        color: white;
        border-color: var(--primary-color);
    }

    .flag-icon {
        font-size: 1.2rem;
    }

    .form-container {
        max-width: 400px;
        width: 100%;
        margin: 0 auto;
    }

    .form-header {
        margin-bottom: 40px;
        text-align: center;
    }

    .form-header h1 {
        font-size: 2.5rem;
        color: var(--primary-color);
        margin-bottom: 10px;
    }

    .form-header p {
        color: #666;
        font-size: 1.05rem;
    }

    .form-group {
        margin-bottom: 25px;
        position: relative;
    }

    .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: var(--dark-color);
    }

    .input-with-icon {
        position: relative;
    }

    .input-with-icon i {
        position: absolute;
        top: 50%;
        left: 15px;
        transform: translateY(-50%);
        color: var(--primary-color);
        font-size: 1.1rem;
    }

    .form-control {
        width: 100%;
        padding: 15px 15px 15px 45px;
        border: 2px solid #e1e8f0;
        border-radius: 12px;
        font-size: 1rem;
        transition: var(--transition);
        background-color: #fafeff;
    }

    .form-control:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(93, 138, 168, 0.2);
    }

    /* Show/hide password button */
    .toggle-password {
        position: absolute;
        right: 15px;
        top: 50%;
        transform: translateY(-50%);
        background: none;
        border: none;
        color: var(--primary-color);
        cursor: pointer;
        font-size: 1rem;
        padding: 5px;
    }

    .form-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        font-size: 0.95rem;
    }

    .remember-me {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .remember-me input {
        width: 18px;
        height: 18px;
        accent-color: var(--primary-color);
    }

    .forgot-password {
        color: var(--primary-color);
        text-decoration: none;
        font-weight: 500;
        transition: var(--transition);
        cursor: pointer;
    }

    .forgot-password:hover {
        color: var(--accent-color);
        text-decoration: underline;
    }

    .btn {
        display: block;
        width: 100%;
        padding: 16px;
        border: none;
        border-radius: 12px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
    }

    .btn-primary {
        background-color: var(--primary-color);
        color: white;
        margin-bottom: 20px;
    }

    .btn-primary:hover {
        background-color: #4a7694;
        transform: translateY(-2px);
        box-shadow: 0 7px 14px rgba(93, 138, 168, 0.2);
    }

    .btn-secondary {
        background-color: var(--light-color);
        color: var(--primary-color);
        border: 2px solid var(--secondary-color);
        margin-top: 10px;
    }

    .btn-secondary:hover {
        background-color: #edf4fa;
    }

    /* Verification Sections */
    .verification-section, .forgot-password-section, .reset-password-section {
        display: none;
        margin-top: 30px;
        padding: 25px;
        background-color: #f8fbff;
        border-radius: 15px;
        border: 2px dashed var(--secondary-color);
        animation: fadeIn 0.5s ease-out;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .verification-section h3, .forgot-password-section h3, .reset-password-section h3 {
        color: var(--primary-color);
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .verification-section h3 i, .forgot-password-section h3 i, .reset-password-section h3 i {
        color: var(--success-color);
    }

    /* Verification Code */
    .code-inputs {
        display: flex;
        justify-content: space-between;
        margin-bottom: 20px;
    }

    .code-input, .reset-code-input {
        width: 60px;
        height: 70px;
        text-align: center;
        font-size: 1.8rem;
        font-weight: bold;
        border: 2px solid #e1e8f0;
        border-radius: 10px;
        background-color: white;
        transition: var(--transition);
    }

    .code-input:focus, .reset-code-input:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(93, 138, 168, 0.2);
    }

    .code-input::-webkit-outer-spin-button,
    .code-input::-webkit-inner-spin-button,
    .reset-code-input::-webkit-outer-spin-button,
    .reset-code-input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }

    .code-input[type=number],
    .reset-code-input[type=number] {
        -moz-appearance: textfield;
    }

    .resend-code {
        text-align: center;
        margin-top: 15px;
        font-size: 0.95rem;
    }

    .resend-code a {
        color: var(--primary-color);
        font-weight: 500;
        text-decoration: none;
        cursor: pointer;
    }

    .resend-code a:hover {
        text-decoration: underline;
    }

    /* Alerts */
    .alert {
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 12px;
        animation: fadeIn 0.5s ease-out;
        display: none;
    }

    .alert i {
        font-size: 1.3rem;
    }

    .alert-success {
        background-color: rgba(123, 207, 169, 0.15);
        color: #1e7a56;
        border-left: 4px solid var(--success-color);
    }

    .alert-info {
        background-color: rgba(93, 138, 168, 0.15);
        color: var(--dark-color);
        border-left: 4px solid var(--primary-color);
    }

    .alert-warning {
        background-color: rgba(255, 179, 71, 0.15);
        color: #b37400;
        border-left: 4px solid var(--accent-color);
    }

    .alert-error {
        background-color: rgba(231, 76, 60, 0.15);
        color: #c0392b;
        border-left: 4px solid var(--error-color);
    }

    /* Password strength indicator */
    .password-strength {
        margin-top: 10px;
        height: 6px;
        border-radius: 3px;
        background-color: #e1e8f0;
        overflow: hidden;
    }

    .strength-bar {
        height: 100%;
        width: 0%;
        transition: width 0.3s ease;
        border-radius: 3px;
    }

    .strength-weak {
        background-color: #e74c3c;
        width: 33%;
    }

    .strength-medium {
        background-color: #ffb347;
        width: 66%;
    }

    .strength-strong {
        background-color: #7bcfa9;
        width: 100%;
    }

    .password-hint {
        font-size: 0.85rem;
        color: #666;
        margin-top: 5px;
        display: flex;
        align-items: center;
        gap: 5px;
    }

    .password-hint i {
        font-size: 0.9rem;
    }

    /* Signup link */
    .signup-link {
        text-align: center;
        margin-top: 30px;
        font-size: 0.95rem;
    }

    .signup-link a {
        color: var(--primary-color);
        font-weight: 600;
        text-decoration: none;
    }

    .signup-link a:hover {
        text-decoration: underline;
    }

    /* Back to login */
    .back-to-login {
        text-align: center;
        margin-top: 15px;
        font-size: 0.95rem;
    }

    .back-to-login a {
        color: var(--primary-color);
        font-weight: 500;
        text-decoration: none;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 5px;
    }

    .back-to-login a:hover {
        text-decoration: underline;
    }

    /* Toast */
    .toast-container {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 9999;
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .toast {
        background: white;
        border-radius: 8px;
        padding: 15px 20px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        display: flex;
        align-items: center;
        gap: 12px;
        animation: slideIn 0.3s ease-out;
        min-width: 300px;
        max-width: 400px;
    }

    .toast.success {
        border-left: 4px solid var(--success-color);
    }

    .toast.error {
        border-left: 4px solid var(--error-color);
    }

    .toast.info {
        border-left: 4px solid var(--primary-color);
    }

    .toast.warning {
        border-left: 4px solid var(--accent-color);
    }

    .toast i {
        font-size: 1.2rem;
    }

    .toast.success i {
        color: var(--success-color);
    }

    .toast.error i {
        color: var(--error-color);
    }

    .toast.info i {
        color: var(--primary-color);
    }

    .toast.warning i {
        color: var(--accent-color);
    }

    .toast-content {
        flex: 1;
    }

    .toast-close {
        background: none;
        border: none;
        color: #666;
        cursor: pointer;
        font-size: 1rem;
        padding: 5px;
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateX(100%);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    /* Loader */
    .loader-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.9);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9998;
        display: none;
    }

    .loader {
        text-align: center;
    }

    .spinner {
        width: 50px;
        height: 50px;
        border: 4px solid var(--light-color);
        border-top: 4px solid var(--primary-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 15px;
    }

    .loading-text {
        color: var(--dark-color);
        font-weight: 500;
    }

    /* Responsive */
    @media (max-width: 900px) {
        .container {
            flex-direction: column;
            max-width: 500px;
        }

        .graphic-side {
            padding: 30px;
            min-height: 250px;
        }

        .graphic-side h2 {
            font-size: 2.5rem;
        }

        .illustration {
            font-size: 5rem;
            margin-top: 20px;
        }

        .form-side {
            padding: 40px 30px;
        }

        .language-switcher {
            top: 20px;
            left: 20px;
        }

        .toast {
            min-width: 250px;
            max-width: 300px;
            right: 10px;
            bottom: 10px;
        }
    }

    @media (max-width: 480px) {
        .form-footer {
            flex-direction: column;
            gap: 15px;
            align-items: flex-start;
        }

        .code-input, .reset-code-input {
            width: 45px;
            height: 60px;
            font-size: 1.5rem;
        }

        .code-inputs {
            gap: 8px;
        }

        .language-switcher {
            position: relative;
            top: 0;
            left: 0;
            justify-content: center;
            margin-bottom: 20px;
        }

        .toast {
            min-width: 200px;
            max-width: 250px;
            padding: 12px 15px;
        }
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    </style>
</head>
<body dir="ltr">
    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Loader -->
    <div class="loader-overlay" id="loaderOverlay">
        <div class="loader">
            <div class="spinner"></div>
            <div class="loading-text loading-ar" style="display: none;">جاري المعالجة...</div>
            <div class="loading-text loading-en">Processing...</div>
        </div>
    </div>

    <div class="container">
        <!-- Graphic Side -->
        <div class="graphic-side">
            <div class="logo">
                <i class="fas fa-brain"></i>
            </div>
            <h2>CalmAI</h2>
            <p class="slogan-ar" style="display:none;">مساحتك الذكية للراحة النفسية والدعم المعنوي</p>
            <p class="slogan-en">Your intelligent space for mental peace and emotional support</p>
            <div class="illustration">
                <i class="fas fa-heart"></i>
            </div>
        </div>

        <!-- Form Side -->
        <div class="form-side">
            <!-- Language Switcher -->
            <div class="language-switcher">
                <button class="lang-btn" data-lang="ar">
                    <span class="flag-icon fi fi-ae"></span>
                    <span class="lang-text">العربية</span>
                </button>
                <button class="lang-btn active" data-lang="en">
                    <span class="flag-icon fi fi-us"></span>
                    <span class="lang-text">English</span>
                </button>
            </div>

            <div class="form-container">
                <!-- Login Form Container -->
                <div id="loginFormContainer">
                    <div class="form-header">
                        <h1 class="login-title-ar" style="display:none;">تسجيل الدخول</h1>
                        <h1 class="login-title-en">Login</h1>
                        <p class="welcome-ar" style="display:none;">مرحبا بعودتك! يرجى تسجيل الدخول للوصول إلى مساحتك الآمنة</p>
                        <p class="welcome-en">Welcome back! Please login to access your safe space.</p>
                    </div>

                    <!-- Verification Code Alert -->
                    <div class="alert alert-info" id="verificationAlert">
                        <i class="fas fa-info-circle"></i>
                        <div class="alert-text-ar" style="display:none;">تم إرسال رمز التحقق إلى بريدك الإلكتروني. يرجى إدخاله أدناه</div>
                        <div class="alert-text-en">Verification code has been sent to your email. Please enter it below.</div>
                    </div>

                    <form id="loginForm">
                        <div class="form-group">
                            <label for="email" class="email-label-ar" style="display:none;">البريد الإلكتروني</label>
                            <label for="email" class="email-label-en">Email Address</label>
                            <div class="input-with-icon">
                                <input type="email" id="email" class="form-control" placeholder="example@domain.com" required>
                                <i class="fas fa-envelope"></i>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="password" class="password-label-ar" style="display:none;">كلمة المرور</label>
                            <label for="password" class="password-label-en">Password</label>
                            <div class="input-with-icon">
                                <input type="password" id="password" class="form-control" placeholder="Enter your password" required>
                                <i class="fas fa-lock"></i>
                                <button type="button" class="toggle-password" aria-label="Show password">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>

                        <div class="form-footer">
                            <div class="remember-me">
                                <input type="checkbox" id="remember">
                                <label for="remember" class="remember-label-ar" style="display:none;">تذكرني</label>
                                <label for="remember" class="remember-label-en">Remember me</label>
                            </div>
                            <a class="forgot-password forgot-ar" id="forgotPasswordLink" style="display:none;">نسيت كلمة المرور؟</a>
                            <a class="forgot-password forgot-en" id="forgotPasswordLinkEn">Forgot password?</a>
                        </div>

                        <button type="submit" class="btn btn-primary login-btn-ar" style="display:none;">تسجيل الدخول</button>
                        <button type="submit" class="btn btn-primary login-btn-en">Login</button>
                    </form>

                    <!-- Verification Code Section -->
                    <div class="verification-section" id="verificationSection">
                        <h3><i class="fas fa-shield-alt"></i> <span class="verify-title-ar" style="display:none;">تأكيد البريد الإلكتروني</span><span class="verify-title-en">Email Verification</span></h3>
                        <p class="verify-desc-ar" style="display:none;">لقد أرسلنا رمز التحقق إلى بريدك الإلكتروني. الرمز صالح لمدة 10 دقائق.</p>
                        <p class="verify-desc-en">We've sent a verification code to your email. The code is valid for 10 minutes.</p>

                        <div class="code-inputs">
                            <input type="text" class="code-input" maxlength="1" data-index="0" inputmode="numeric" pattern="[0-9]*">
                            <input type="text" class="code-input" maxlength="1" data-index="1" inputmode="numeric" pattern="[0-9]*">
                            <input type="text" class="code-input" maxlength="1" data-index="2" inputmode="numeric" pattern="[0-9]*">
                            <input type="text" class="code-input" maxlength="1" data-index="3" inputmode="numeric" pattern="[0-9]*">
                            <input type="text" class="code-input" maxlength="1" data-index="4" inputmode="numeric" pattern="[0-9]*">
                            <input type="text" class="code-input" maxlength="1" data-index="5" inputmode="numeric" pattern="[0-9]*">
                        </div>

                        <button type="button" class="btn btn-primary verify-btn-ar" id="verifyCode" style="display:none;">تأكيد الرمز</button>
                        <button type="button" class="btn btn-primary verify-btn-en" id="verifyCodeEn">Verify Code</button>

                        <div class="resend-code">
                            <p class="resend-text-ar" style="display:none;">لم تستلم الرمز؟ <a id="resendLink">إعادة إرسال الرمز</a></p>
                            <p class="resend-text-en">Didn't receive the code? <a id="resendLinkEn">Resend Code</a></p>
                            <p id="countdown"><span class="timer-text-ar" style="display:none;">يمكنك إعادة الإرسال بعد </span><span class="timer-text-en">You can resend in </span><span id="timer">60</span><span class="seconds-ar" style="display:none;"> ثانية</span><span class="seconds-en"> seconds</span></p>
                        </div>
                    </div>

                    <div class="signup-link">
                        <p class="signup-text-ar" style="display:none;">ليس لديك حساب؟ <a href="signup.html" class="signup-link-ar">إنشاء حساب جديد</a></p>
                        <p class="signup-text-en">Don't have an account? <a href="signup.html" class="signup-link-en">Create new account</a></p>
                    </div>
                </div>

                <!-- Forgot Password Section -->
                <div class="forgot-password-section" id="forgotPasswordSection" style="display:none;">
                    <div class="form-header">
                        <h1 class="forgot-title-ar" style="display:none;">استعادة كلمة المرور</h1>
                        <h1 class="forgot-title-en">Password Recovery</h1>
                        <p class="forgot-desc-ar" style="display:none;">أدخل بريدك الإلكتروني وسنرسل لك رمز التحقق لإعادة تعيين كلمة المرور</p>
                        <p class="forgot-desc-en">Enter your email address and we'll send you a verification code to reset your password.</p>
                    </div>

                    <div class="alert alert-info" id="forgotAlert">
                        <i class="fas fa-info-circle"></i>
                        <div class="forgot-alert-text-ar" style="display:none;">سنرسل رمز التحقق إلى بريدك الإلكتروني للتحقق من هويتك</div>
                        <div class="forgot-alert-text-en">We'll send a verification code to your email to verify your identity.</div>
                    </div>

                    <form id="forgotPasswordForm">
                        <div class="form-group">
                            <label for="forgotEmail" class="forgot-email-label-ar" style="display:none;">البريد الإلكتروني</label>
                            <label for="forgotEmail" class="forgot-email-label-en">Email Address</label>
                            <div class="input-with-icon">
                                <input type="email" id="forgotEmail" class="form-control" placeholder="example@domain.com" required>
                                <i class="fas fa-envelope"></i>
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary send-code-btn-ar" style="display:none;">إرسال رمز التحقق</button>
                        <button type="submit" class="btn btn-primary send-code-btn-en">Send Verification Code</button>
                    </form>

                    <div class="back-to-login">
                        <a id="backToLoginLink"><i class="fas fa-arrow-right"></i> <span class="back-to-login-ar" style="display:none;">العودة لتسجيل الدخول</span><span class="back-to-login-en">Back to Login</span></a>
                    </div>
                </div>

                <!-- Reset Password Section -->
                <div class="reset-password-section" id="resetPasswordSection" style="display:none;">
                    <div class="form-header">
                        <h1 class="reset-title-ar" style="display:none;">إعادة تعيين كلمة المرور</h1>
                        <h1 class="reset-title-en">Reset Password</h1>
                        <p class="reset-desc-ar" style="display:none;">أدخل رمز التحقق الذي استلمته على بريدك الإلكتروني ثم عين كلمة مرور جديدة</p>
                        <p class="reset-desc-en">Enter the verification code you received in your email and set a new password.</p>
                    </div>

                    <div class="alert alert-info" id="resetAlert">
                        <i class="fas fa-info-circle"></i>
                        <div class="reset-alert-text-ar" style="display:none;">أدخل رمز التحقق المكون من 6 أرقام وكلمة المرور الجديدة</div>
                        <div class="reset-alert-text-en">Enter the 6-digit verification code and your new password.</div>
                    </div>

                    <form id="resetPasswordForm">
                        <div class="form-group">
                            <label class="reset-code-label-ar" style="display:none;">رمز التحقق</label>
                            <label class="reset-code-label-en">Verification Code</label>
                            <div class="code-inputs">
                                <input type="text" class="reset-code-input" maxlength="1" data-index="0" inputmode="numeric" pattern="[0-9]*">
                                <input type="text" class="reset-code-input" maxlength="1" data-index="1" inputmode="numeric" pattern="[0-9]*">
                                <input type="text" class="reset-code-input" maxlength="1" data-index="2" inputmode="numeric" pattern="[0-9]*">
                                <input type="text" class="reset-code-input" maxlength="1" data-index="3" inputmode="numeric" pattern="[0-9]*">
                                <input type="text" class="reset-code-input" maxlength="1" data-index="4" inputmode="numeric" pattern="[0-9]*">
                                <input type="text" class="reset-code-input" maxlength="1" data-index="5" inputmode="numeric" pattern="[0-9]*">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="newPassword" class="new-password-label-ar" style="display:none;">كلمة المرور الجديدة</label>
                            <label for="newPassword" class="new-password-label-en">New Password</label>
                            <div class="input-with-icon">
                                <input type="password" id="newPassword" class="form-control" placeholder="New password" required>
                                <i class="fas fa-lock"></i>
                                <button type="button" class="toggle-password" aria-label="Show password">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <div class="password-strength">
                                <div class="strength-bar" id="passwordStrengthBar"></div>
                            </div>
                            <div class="password-hint">
                                <i class="fas fa-info-circle"></i>
                                <span class="password-hint-text-ar" style="display:none;">يجب أن تحتوي كلمة المرور على 8 أحرف على الأقل، وتشمل حرف كبير، رقم ورموز خاص</span>
                                <span class="password-hint-text-en">Password must be at least 8 characters, include uppercase, number and special character.</span>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="confirmPassword" class="confirm-password-label-ar" style="display:none;">تأكيد كلمة المرور الجديدة</label>
                            <label for="confirmPassword" class="confirm-password-label-en">Confirm Password</label>
                            <div class="input-with-icon">
                                <input type="password" id="confirmPassword" class="form-control" placeholder="Confirm new password" required>
                                <i class="fas fa-lock"></i>
                                <button type="button" class="toggle-password" aria-label="Show password">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary reset-btn-ar" style="display:none;">تعيين كلمة المرور الجديدة</button>
                        <button type="submit" class="btn btn-primary reset-btn-en">Set New Password</button>
                    </form>

                    <div class="back-to-login">
                        <a id="backToLoginLink2"><i class="fas fa-arrow-right"></i> <span class="back-to-login-ar" style="display:none;">العودة لتسجيل الدخول</span><span class="back-to-login-en">Back to Login</span></a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Hide alerts initially
        document.getElementById('verificationAlert').style.display = 'none';
        document.getElementById('verificationSection').style.display = 'none';

        // Countdown variables
        let countdown = 60;
        let countdownInterval;
        const timerElement = document.getElementById('timer');
        const resendLinkEn = document.getElementById('resendLinkEn');

        // Language selection
        const langButtons = document.querySelectorAll('.lang-btn');
        let currentLang = 'en';

        // Initialize English as default
        initializeEnglish();

        // Auto focus on first field
        document.getElementById('email').focus();

        // Initialize password toggles
        initPasswordToggles();

        // Handle language change
        langButtons.forEach(btn => {
            btn.addEventListener('click', function() {
                const lang = this.dataset.lang;

                // Update language buttons
                langButtons.forEach(b => b.classList.remove('active'));
                this.classList.add('active');

                // Change language
                switchLanguage(lang);
                currentLang = lang;
            });
        });

        // Forgot password link
        document.getElementById('forgotPasswordLinkEn').addEventListener('click', function() {
            showForgotPasswordSection();
        });

        // Back to login links
        document.getElementById('backToLoginLink').addEventListener('click', function() {
            showLoginSection();
        });

        document.getElementById('backToLoginLink2').addEventListener('click', function() {
            showLoginSection();
        });

        // Login form submission
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const rememberMe = document.getElementById('remember').checked;

            // Basic validation
            if (!email || !password) {
                showToast('Please fill in all required fields', 'error');
                return;
            }

            // Email format validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showToast('Please enter a valid email address', 'error');
                return;
            }

            // Show loader
            showLoader();

            try {
                // Send login request to server
                const response = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        email: email,
                        password: password
                    })
                });

                const data = await response.json();

                if (data.success) {
                    // Store token and user data
                    if (rememberMe) {
                        localStorage.setItem('token', data.token);
                        localStorage.setItem('user', JSON.stringify(data.user));
                    } else {
                        sessionStorage.setItem('token', data.token);
                        sessionStorage.setItem('user', JSON.stringify(data.user));
                    }

                    // Show success message
                    showToast('Login successful!', 'success');
                    
                    // Redirect to dashboard after 1 second
                    setTimeout(() => {
                        window.location.href = 'dashboard.html';
                    }, 1000);
                    
                } else {
                    showToast(data.error || 'Login failed', 'error');
                }
            } catch (error) {
                console.error('Login error:', error);
                showToast('Connection error with server', 'error');
            } finally {
                hideLoader();
            }
        });

        // Forgot password form submission
        document.getElementById('forgotPasswordForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const email = document.getElementById('forgotEmail').value;

            if (!email) {
                showToast('Please enter your email address', 'error');
                return;
            }

            // Email format validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showToast('Please enter a valid email address', 'error');
                return;
            }

            // Show loader
            showLoader();

            try {
                // Send password reset request to server
                const response = await fetch('/api/auth/reset-password', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        email: email
                    })
                });

                const data = await response.json();

                if (data.success) {
                    showToast('Verification code has been sent to your email. Please check your inbox', 'success');
                    
                    // Show reset password section
                    showResetPasswordSection();
                    
                    // Store email for verification
                    localStorage.setItem('reset_email', email);
                } else {
                    showToast(data.error || 'Failed to send verification code', 'error');
                }
            } catch (error) {
                console.error('Forgot password error:', error);
                showToast('Connection error with server', 'error');
            } finally {
                hideLoader();
            }
        });

        // Reset password form submission
        document.getElementById('resetPasswordForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            // Get verification code
            let resetCode = "";
            document.querySelectorAll('.reset-code-input').forEach(input => resetCode += input.value);

            if (resetCode.length !== 6) {
                showToast('Please enter the 6-digit verification code', 'error');
                return;
            }

            if (!newPassword || !confirmPassword) {
                showToast('Please fill in all required fields', 'error');
                return;
            }

            if (newPassword !== confirmPassword) {
                showToast('Passwords do not match', 'error');
                return;
            }

            // Password strength validation
            if (!validatePasswordStrength(newPassword)) {
                showToast('Password is weak. Please choose a stronger password', 'error');
                return;
            }

            const email = localStorage.getItem('reset_email');

            // Show loader
            showLoader();

            try {
                // Send reset password request to server
                const response = await fetch('/api/auth/reset-password', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        email: email,
                        verification_code: resetCode,
                        new_password: newPassword
                    })
                });

                const data = await response.json();

                if (data.success) {
                    showToast('Password has been reset successfully! You can now login with your new password', 'success');
                    
                    // Clear reset data
                    localStorage.removeItem('reset_email');
                    
                    // Go back to login
                    showLoginSection();
                    
                    // Clear reset form
                    document.getElementById('resetPasswordForm').reset();
                    document.querySelectorAll('.reset-code-input').forEach(input => input.value = "");
                    document.getElementById('passwordStrengthBar').className = 'strength-bar';
                } else {
                    showToast(data.error || 'Password reset failed', 'error');
                }
            } catch (error) {
                console.error('Reset password error:', error);
                showToast('Connection error with server', 'error');
            } finally {
                hideLoader();
            }
        });

        // Password strength indicator for reset form
        document.getElementById('newPassword').addEventListener('input', function() {
            const password = this.value;
            const strengthBar = document.getElementById('passwordStrengthBar');

            if (password.length === 0) {
                strengthBar.className = 'strength-bar';
                return;
            }

            // Calculate password strength
            let strength = 0;

            // Length check
            if (password.length >= 8) strength++;
            if (password.length >= 12) strength++;

            // Complexity checks
            if (/[A-Z]/.test(password)) strength++;
            if (/[0-9]/.test(password)) strength++;
            if (/[^A-Za-z0-9]/.test(password)) strength++;

            // Update strength bar
            if (strength <= 2) {
                strengthBar.className = 'strength-bar strength-weak';
            } else if (strength <= 4) {
                strengthBar.className = 'strength-bar strength-medium';
            } else {
                strengthBar.className = 'strength-bar strength-strong';
            }
        });

        // Verification code input handling (for login)
        const codeInputs = document.querySelectorAll('.code-input');
        setupCodeInputs(codeInputs);

        // Reset password code input handling
        const resetCodeInputs = document.querySelectorAll('.reset-code-input');
        setupCodeInputs(resetCodeInputs);

        // Verify code button
        document.getElementById('verifyCodeEn').addEventListener('click', verifyLoginCode);

        // Resend code link
        resendLinkEn.addEventListener('click', function(e) {
            e.preventDefault();
            resendLoginCode();
        });

        // Function to setup code inputs
        function setupCodeInputs(inputs) {
            inputs.forEach(input => {
                input.addEventListener('input', function() {
                    const value = this.value;
                    const index = parseInt(this.dataset.index);

                    // Only allow digits
                    if (value && !/^\d$/.test(value)) {
                        this.value = "";
                        return;
                    }

                    // Auto-focus next input
                    if (value.length === 1 && index < inputs.length - 1) {
                        inputs[index + 1].focus();
                    }

                    // Auto-verify when last digit entered
                    if (index === inputs.length - 1 && value.length === 1) {
                        setTimeout(verifyLoginCode, 100);
                    }
                });

                input.addEventListener('keydown', function(e) {
                    const index = parseInt(this.dataset.index);

                    // Move to previous input on backspace
                    if (e.key === 'Backspace' && this.value === "" && index > 0) {
                        inputs[index - 1].focus();
                    }

                    // Allow navigation with arrow keys
                    if (e.key === 'ArrowLeft' && index > 0) {
                        inputs[index - 1].focus();
                        e.preventDefault();
                    }

                    if (e.key === 'ArrowRight' && index < inputs.length - 1) {
                        inputs[index + 1].focus();
                        e.preventDefault();
                    }
                });
            });
        }

        // Verify login code function
        async function verifyLoginCode() {
            let code = "";
            codeInputs.forEach(input => code += input.value);

            if (code.length !== 6) {
                showToast('Please enter the 6-digit verification code', 'error');
                return;
            }

            // In a real app, you would verify the code with the server
            showToast('Code verified successfully!', 'success');
            
            // Clear inputs
            codeInputs.forEach(input => input.value = "");
            
            // Hide verification section
            document.getElementById('verificationSection').style.display = 'none';
            document.getElementById('verificationAlert').style.display = 'none';
        }

        // Resend code function
        async function resendLoginCode() {
            // Reset timer
            countdown = 60;
            startCountdown();

            // Show confirmation message
            showToast('Verification code has been resent to your email', 'info');

            // Clear inputs and focus first
            codeInputs.forEach(input => input.value = "");
            codeInputs[0].focus();
        }

        // Start countdown timer
        function startCountdown() {
            // Clear previous interval
            if (countdownInterval) {
                clearInterval(countdownInterval);
            }

            // Disable resend link
            resendLinkEn.style.pointerEvents = 'none';
            resendLinkEn.style.opacity = '0.6';

            // Update timer every second
            countdownInterval = setInterval(() => {
                countdown--;
                timerElement.textContent = countdown;

                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    resendLinkEn.style.pointerEvents = 'auto';
                    resendLinkEn.style.opacity = '1';
                }
            }, 1000);
        }

        // Show login section
        function showLoginSection() {
            document.getElementById('loginFormContainer').style.display = 'block';
            document.getElementById('forgotPasswordSection').style.display = 'none';
            document.getElementById('resetPasswordSection').style.display = 'none';
            document.getElementById('verificationAlert').style.display = 'none';
            document.getElementById('verificationSection').style.display = 'none';

            // Focus on email field
            document.getElementById('email').focus();
        }

        // Show forgot password section
        function showForgotPasswordSection() {
            document.getElementById('loginFormContainer').style.display = 'none';
            document.getElementById('forgotPasswordSection').style.display = 'block';
            document.getElementById('resetPasswordSection').style.display = 'none';
            document.getElementById('verificationAlert').style.display = 'none';
            document.getElementById('verificationSection').style.display = 'none';

            // Clear any previous input
            document.getElementById('forgotEmail').value = '';

            // Focus on email field
            document.getElementById('forgotEmail').focus();
        }

        // Show reset password section
        function showResetPasswordSection() {
            document.getElementById('loginFormContainer').style.display = 'none';
            document.getElementById('forgotPasswordSection').style.display = 'none';
            document.getElementById('resetPasswordSection').style.display = 'block';
            document.getElementById('verificationAlert').style.display = 'none';
            document.getElementById('verificationSection').style.display = 'none';

            // Clear any previous input
            document.querySelectorAll('.reset-code-input').forEach(input => input.value = '');
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';
            document.getElementById('passwordStrengthBar').className = 'strength-bar';

            // Focus first code input
            document.querySelector('.reset-code-input').focus();
        }

        // Validate password strength
        function validatePasswordStrength(password) {
            // At least 8 characters
            if (password.length < 8) return false;

            // Contains at least one uppercase letter
            if (!/[A-Z]/.test(password)) return false;

            // Contains at least one number
            if (!/[0-9]/.test(password)) return false;

            // Contains at least one special character
            if (!/[^A-Za-z0-9]/.test(password)) return false;

            return true;
        }

        // Initialize English language
        function initializeEnglish() {
            // Show English elements
            document.querySelectorAll('.slogan-en, .login-title-en, .welcome-en, .email-label-en, .password-label-en, .remember-label-en, .forgot-en, .login-btn-en, .alert-text-en, .verify-title-en, .verify-desc-en, .verify-btn-en, .resend-text-en, .timer-text-en, .seconds-en, .signup-text-en, .forgot-title-en, .forgot-desc-en, .forgot-alert-text-en, .forgot-email-label-en, .send-code-btn-en, .back-to-login-en, .reset-title-en, .reset-desc-en, .reset-alert-text-en, .reset-code-label-en, .new-password-label-en, .password-hint-text-en, .confirm-password-label-en, .reset-btn-en, .loading-en')
                .forEach(el => el.style.display = '');

            // Hide Arabic elements
            document.querySelectorAll('.slogan-ar, .login-title-ar, .welcome-ar, .email-label-ar, .password-label-ar, .remember-label-ar, .forgot-ar, .login-btn-ar, .alert-text-ar, .verify-title-ar, .verify-desc-ar, .verify-btn-ar, .resend-text-ar, .timer-text-ar, .seconds-ar, .signup-text-ar, .forgot-title-ar, .forgot-desc-ar, .forgot-alert-text-ar, .forgot-email-label-ar, .send-code-btn-ar, .back-to-login-ar, .reset-title-ar, .reset-desc-ar, .reset-alert-text-ar, .reset-code-label-ar, .new-password-label-ar, .password-hint-text-ar, .confirm-password-label-ar, .reset-btn-ar, .loading-ar')
                .forEach(el => el.style.display = 'none');

            // Set LTR direction for English
            document.documentElement.dir = 'ltr';
            document.documentElement.lang = 'en';

            // Position icons on left for English
            document.querySelectorAll('.input-with-icon i').forEach(icon => {
                icon.style.left = '15px';
                icon.style.right = 'auto';
            });

            // Position toggle password buttons for English
            document.querySelectorAll('.toggle-password').forEach(button => {
                button.style.right = '15px';
                button.style.left = 'auto';
                button.setAttribute('aria-label', 'Show password');
            });

            // Update placeholders for English
            document.getElementById('email').placeholder = 'example@domain.com';
            document.getElementById('password').placeholder = 'Enter your password';
            document.getElementById('forgotEmail').placeholder = 'example@domain.com';
            document.getElementById('newPassword').placeholder = 'New password';
            document.getElementById('confirmPassword').placeholder = 'Confirm new password';
        }

        // Switch language function
        function switchLanguage(lang) {
            if (lang === 'ar') {
                // Show Arabic elements
                document.querySelectorAll('.slogan-ar, .login-title-ar, .welcome-ar, .email-label-ar, .password-label-ar, .remember-label-ar, .forgot-ar, .login-btn-ar, .alert-text-ar, .verify-title-ar, .verify-desc-ar, .verify-btn-ar, .resend-text-ar, .timer-text-ar, .seconds-ar, .signup-text-ar, .forgot-title-ar, .forgot-desc-ar, .forgot-alert-text-ar, .forgot-email-label-ar, .send-code-btn-ar, .back-to-login-ar, .reset-title-ar, .reset-desc-ar, .reset-alert-text-ar, .reset-code-label-ar, .new-password-label-ar, .password-hint-text-ar, .confirm-password-label-ar, .reset-btn-ar, .loading-ar')
                    .forEach(el => el.style.display = '');

                // Hide English elements
                document.querySelectorAll('.slogan-en, .login-title-en, .welcome-en, .email-label-en, .password-label-en, .remember-label-en, .forgot-en, .login-btn-en, .alert-text-en, .verify-title-en, .verify-desc-en, .verify-btn-en, .resend-text-en, .timer-text-en, .seconds-en, .signup-text-en, .forgot-title-en, .forgot-desc-en, .forgot-alert-text-en, .forgot-email-label-en, .send-code-btn-en, .back-to-login-en, .reset-title-en, .reset-desc-en, .reset-alert-text-en, .reset-code-label-en, .new-password-label-en, .password-hint-text-en, .confirm-password-label-en, .reset-btn-en, .loading-en')
                    .forEach(el => el.style.display = 'none');

                // Set RTL direction
                document.documentElement.dir = 'rtl';
                document.documentElement.lang = 'ar';

                // Position icons on right
                document.querySelectorAll('.input-with-icon i').forEach(icon => {
                    icon.style.right = '15px';
                    icon.style.left = 'auto';
                });

                // Position toggle password buttons for Arabic
                document.querySelectorAll('.toggle-password').forEach(button => {
                    button.style.left = '15px';
                    button.style.right = 'auto';
                    button.setAttribute('aria-label', 'إظهار كلمة المرور');
                });

                // Update placeholders
                document.getElementById('email').placeholder = 'example@domain.com';
                document.getElementById('password').placeholder = 'أدخل كلمة المرور';
                document.getElementById('forgotEmail').placeholder = 'example@domain.com';
                document.getElementById('newPassword').placeholder = 'كلمة المرور الجديدة';
                document.getElementById('confirmPassword').placeholder = 'تأكيد كلمة المرور الجديدة';

            } else {
                // Show English elements
                document.querySelectorAll('.slogan-en, .login-title-en, .welcome-en, .email-label-en, .password-label-en, .remember-label-en, .forgot-en, .login-btn-en, .alert-text-en, .verify-title-en, .verify-desc-en, .verify-btn-en, .resend-text-en, .timer-text-en, .seconds-en, .signup-text-en, .forgot-title-en, .forgot-desc-en, .forgot-alert-text-en, .forgot-email-label-en, .send-code-btn-en, .back-to-login-en, .reset-title-en, .reset-desc-en, .reset-alert-text-en, .reset-code-label-en, .new-password-label-en, .password-hint-text-en, .confirm-password-label-en, .reset-btn-en, .loading-en')
                    .forEach(el => el.style.display = '');

                // Hide Arabic elements
                document.querySelectorAll('.slogan-ar, .login-title-ar, .welcome-ar, .email-label-ar, .password-label-ar, .remember-label-ar, .forgot-ar, .login-btn-ar, .alert-text-ar, .verify-title-ar, .verify-desc-ar, .verify-btn-ar, .resend-text-ar, .timer-text-ar, .seconds-ar, .signup-text-ar, .forgot-title-ar, .forgot-desc-ar, .forgot-alert-text-ar, .forgot-email-label-ar, .send-code-btn-ar, .back-to-login-ar, .reset-title-ar, .reset-desc-ar, .reset-alert-text-ar, .reset-code-label-ar, .new-password-label-ar, .password-hint-text-ar, .confirm-password-label-ar, .reset-btn-ar, .loading-ar')
                    .forEach(el => el.style.display = 'none');

                // Set LTR direction
                document.documentElement.dir = 'ltr';
                document.documentElement.lang = 'en';

                // Position icons on left
                document.querySelectorAll('.input-with-icon i').forEach(icon => {
                    icon.style.left = '15px';
                    icon.style.right = 'auto';
                });

                // Position toggle password buttons for English
                document.querySelectorAll('.toggle-password').forEach(button => {
                    button.style.right = '15px';
                    button.style.left = 'auto';
                    button.setAttribute('aria-label', 'Show password');
                });

                // Update placeholders
                document.getElementById('email').placeholder = 'example@domain.com';
                document.getElementById('password').placeholder = 'Enter your password';
                document.getElementById('forgotEmail').placeholder = 'example@domain.com';
                document.getElementById('newPassword').placeholder = 'New password';
                document.getElementById('confirmPassword').placeholder = 'Confirm new password';
            }

            // Restart countdown if active
            if (countdownInterval) {
                startCountdown();
            }
        }

        // Show/hide loader
        function showLoader() {
            document.getElementById('loaderOverlay').style.display = 'flex';
        }

        function hideLoader() {
            document.getElementById('loaderOverlay').style.display = 'none';
        }

        // Show toast messages
        function showToast(message, type = 'info') {
            const toastContainer = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.setAttribute('aria-live', 'polite');

            let icon = 'info-circle';
            if (type === 'success') icon = 'check-circle';
            if (type === 'error') icon = 'exclamation-circle';
            if (type === 'warning') icon = 'exclamation-triangle';

            toast.innerHTML = `
                <i class="fas fa-${icon}" aria-hidden="true"></i>
                <div class="toast-content">${message}</div>
                <button class="toast-close" aria-label="Close">
                    <i class="fas fa-times"></i>
                </button>
            `;

            toastContainer.appendChild(toast);

            // Setup close button
            const closeBtn = toast.querySelector('.toast-close');
            if (closeBtn) {
                closeBtn.addEventListener('click', () => {
                    toast.style.opacity = '0';
                    setTimeout(() => toast.remove(), 300);
                });
            }

            // Remove toast after 5 seconds
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.style.opacity = '0';
                    setTimeout(() => toast.remove(), 300);
                }
            }, 5000);
        }

        // Initialize password toggle buttons
        function initPasswordToggles() {
            document.querySelectorAll('.toggle-password').forEach(button => {
                button.addEventListener('click', function() {
                    const input = this.parentElement.querySelector('input');
                    const icon = this.querySelector('i');

                    if (input.type === 'password') {
                        input.type = 'text';
                        icon.classList.remove('fa-eye');
                        icon.classList.add('fa-eye-slash');
                        this.setAttribute('aria-label', currentLang === 'ar' ? 'إخفاء كلمة المرور' : 'Hide password');
                    } else {
                        input.type = 'password';
                        icon.classList.remove('fa-eye-slash');
                        icon.classList.add('fa-eye');
                        this.setAttribute('aria-label', currentLang === 'ar' ? 'إظهار كلمة المرور' : 'Show password');
                    }
                });
            });
        }
    });
    </script>
</body>
</html>
